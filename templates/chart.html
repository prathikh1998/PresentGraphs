<!DOCTYPE html>
<html>
<head>
    <title>Chart Configuration</title>
    <style>
        /* CSS styles */

    </style>
    <script>
        function updateIntervals() {
            var attributeSelect = document.getElementById('attribute');
            var intervalSelect = document.getElementById('interval');
            var form = document.getElementById('chartForm');

            var selectedAttribute = attributeSelect.value;
            intervalSelect.innerHTML = '';

            if (selectedAttribute === 'population') {
                // Interval options for 'population' attribute
                var intervals = [
                    { label: '0-50000', value: '0-50000' },
                    { label: '50001-100000', value: '50001-100000' },
                    { label: '100001-150000', value: '100001-150000' },
                    { label: '150001-200000', value: '150001-200000' },
                    { label: '200001-250000', value: '200001-250000' },
                    { label: '> 250000', value: 'gt' }
                ];
                form.action = '/generate_chart_population';
            } else if (selectedAttribute === 'City') {
                // Interval options for 'City' attribute
                var intervals = [
                    { label: 'New York', value: 'New York' },
                    { label: 'Chicago', value: 'Chicago' },
                    { label: 'Houston', value: 'Houston' },
                    { label: 'Springfield', value: 'Springfield' },
                    { label: 'Los Angeles', value: 'Los Angeles' },
                    { label: 'Philadelphia', value: 'Philadelphia' }
                ];
                form.action = '/generate_chart_city';
            } else if (selectedAttribute === 'state') {
                // Interval options for 'state' attribute
                var intervals = [
                    { label: 'Interval A', value: 'intervalA' },
                    { label: 'Interval B', value: 'intervalB' },
                    { label: 'Interval C', value: 'intervalC' }
                ];
                form.action = '/generate_chart_state';
            } else if (selectedAttribute === 'latlon') {
                // Get latitude and longitude inputs
                var latInput = document.getElementById('latitude');
                var lonInput = document.getElementById('longitude');
                var latitude = parseFloat(latInput.value);
                var longitude = parseFloat(lonInput.value);

                // Perform AJAX request to get the number of cities in the selected location
                fetch('/get_num_cities', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        latitude: latitude,
                        longitude: longitude
                    })
                })
                    .then(function (response) {
                        return response.json();
                    })
                    .then(function (data) {
                        var numCities = data.numCities;
                        var interval = 'Within ' + numCities + ' cities';

                        // Add interval option for the selected location
                        var option = document.createElement('option');
                        option.value = interval;
                        option.text = interval;
                        intervalSelect.add(option);
                    });

                // Set the form action to handle the selected attribute
                form.action = '/get_num_cities';
            }

            // Add interval options to the select element
            intervals.forEach(function (interval) {
                var option = document.createElement('option');
                option.value = interval.value;
                option.text = interval.label;
                intervalSelect.add(option);
            });
        }
    </script>
</head>
<body onload="updateIntervals()">
    <h1>Chart Configuration</h1>
    <form action="/generate_chart" method="post" id="chartForm">
        <label for="attribute">Attribute:</label>
        <select id="attribute" name="attribute" onchange="updateIntervals()">
            <option>Select</option>
            <option value="population">Population</option>
            <option value="City">City</option>
            <option value="state">State</option>
            <option value="latlon">Latitude and Longitude</option>
        </select>
        <br>
        <label for="interval">Interval:</label>
        <select id="interval" name="interval" multiple size="2">
            <!-- Interval options will be dynamically added here -->
        </select>
        <br>
        <label for="latitude">Latitude:</label>
        <input type="text" id="latitude" name="latitude">
        <br>
        <label for="longitude">Longitude:</label>
        <input type="text" id="longitude" name="longitude">
        <br>
        <input type="submit" value="Generate Chart">
    </form>
</body>
</html>
